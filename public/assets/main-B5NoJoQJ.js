import{f as c}from"./fetch-Svz7g7v3.js";const u=document.querySelector(".createuser");u.addEventListener("click",async o=>{o.preventDefault(),console.log("Nyt luodaan käyttäjä");const t="http://127.0.0.1:3000/api/users",e=document.querySelector(".create_user_form");if(!e.checkValidity()){e.reportValidity();return}const s={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value,email:e.querySelector("input[name=email]").value},n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};try{const a=await c(t,n);console.log(a);const i=document.getElementById("notificationUserCreated");i.classList.add("show-notification"),setTimeout(()=>{i.classList.remove("show-notification")},4e3),e.reset()}catch(a){console.error(a)}});document.addEventListener("DOMContentLoaded",function(){const o=document.getElementById("showCreateForm"),t=document.getElementById("showLoginForm"),e=document.getElementById("createFormContainer"),r=document.querySelector(".form-container:not(#createFormContainer)");o.addEventListener("click",()=>{e.classList.remove("hidden"),r.classList.add("hidden")}),t.addEventListener("click",()=>{e.classList.add("hidden"),r.classList.remove("hidden")})});const m=document.querySelector(".loginuser");m.addEventListener("click",async o=>{o.preventDefault(),console.log("Nyt logataan sisään");const t="http://localhost:3000/api/auth/login",e=document.querySelector(".login_form"),r={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value},s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};c(t,s).then(n=>{console.log(n),console.log(n.token),localStorage.setItem("token",n.token),l("loginResponse",`localStorage set with token value: ${n.token}`),n.token==null?alert("Unauthorized: username or password incorrect!"):(alert(n.message),localStorage.setItem("name",n.user.username),setTimeout(function(){window.location.href="home.html"},2e3))})});const d=document.querySelector("#meRequest");d.addEventListener("click",async()=>{console.log("Testataan TOKENIA ja haetaan käyttäjän tiedot");const o="http://localhost:3000/api/auth/me",t=localStorage.getItem("token");console.log("Tämä on haettu LocalStoragesta",t);const e={method:"GET",headers:{Authorization:"Bearer: "+t}};console.log(e),c(o,e).then(r=>{console.log(r),l("meResponse",`Authorized user info: ${JSON.stringify(r)}`)})});const g=document.querySelector("#clearButton");g.addEventListener("click",h);function l(o,t){document.getElementById(o).innerText=t}function h(){localStorage.removeItem("token"),l("clearResponse","localStorage cleared!")}
