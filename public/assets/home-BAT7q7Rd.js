import{f as s}from"./fetch-Svz7g7v3.js";function g(n){const o=document.querySelector(".entry-table tbody");if(o.innerHTML="",n.length===0){const e=document.createElement("tr"),t=document.createElement("td");t.setAttribute("colspan","6"),t.textContent="Ei päiväkirjamerkintöjä vielä, aloita lisäämällä merkintä!",console.log(t.style.color),e.appendChild(t),o.appendChild(e);return}n.forEach(e=>{const t=document.createElement("tr"),i=document.createElement("td");i.textContent=p(e.created_at);const c=document.createElement("td");c.textContent=p(e.entry_date);const r=document.createElement("td");r.textContent=e.mood;const a=document.createElement("td");a.textContent=e.notes;const l=document.createElement("td");l.textContent=e.sleep_hours;const d=document.createElement("td");d.textContent=e.weight,t.appendChild(i),t.appendChild(c),t.appendChild(r),t.appendChild(a),t.appendChild(l),t.appendChild(d),o.appendChild(t)})}function E(n){const o=document.querySelector(".activity-table tbody");if(o.innerHTML="",n.length===0){const e=document.createElement("tr"),t=document.createElement("td");t.setAttribute("colspan","4"),t.textContent="Ei aktiviteetteja vielä, aloita lisäämällä aktiviteetti!",e.appendChild(t),o.appendChild(e);return}n.forEach(e=>{const t=document.createElement("tr"),i=document.createElement("td");i.textContent=p(e.created_at);const c=document.createElement("td");c.textContent=e.activity_type;const r=document.createElement("td");r.textContent=e.intensity;const a=document.createElement("td");a.textContent=e.duration,t.appendChild(i),t.appendChild(c),t.appendChild(r),t.appendChild(a),o.appendChild(t)})}function p(n){const o=new Date(n),e={day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return o.toLocaleString("fi-FI",e)}const v=document.querySelector(".get_entry");v.addEventListener("click",async()=>{const o={method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("token")}};s("http://localhost:3000/api/entries",o).then(t=>{g(t)}).catch(t=>{console.error("Error fetching entries:",t)})});document.addEventListener("DOMContentLoaded",function(){document.querySelector(".get_activity").addEventListener("click",async()=>{const c={method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("token")}};s("http://localhost:3000/api/activities",c).then(a=>{E(a)}).catch(a=>{console.error("Error fetching activities:",a)})});const o=document.getElementById("activityForm"),e=document.querySelector(".activity-table tbody");o.addEventListener("submit",async function(i){i.preventDefault();let c=localStorage.getItem("token");const r=document.getElementById("activityType").value,a=document.getElementById("intensity").value,l=document.getElementById("duration").value,d={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+c},body:JSON.stringify({activity_type:r,intensity:a,duration:l})},u="http://localhost:3000/api/activities";try{const m=await s(u,d);console.log("Activity added successfully:",m),t(m)}catch(m){console.error("Error adding activity:",m)}});function t(i){const c=document.createElement("tr"),r=document.createElement("td");r.textContent=i.created_at;const a=document.createElement("td");a.textContent=i.activity_type;const l=document.createElement("td");l.textContent=i.intensity;const d=document.createElement("td");d.textContent=i.duration,c.appendChild(r),c.appendChild(a),c.appendChild(l),c.appendChild(d),e.appendChild(c)}});const C=document.querySelector(".add-entry");C.addEventListener("click",async n=>{n.preventDefault();let o=localStorage.getItem("token");const e=document.getElementById("entryDate").value,t=document.getElementById("mood").value,i=document.getElementById("weight").value,c=document.getElementById("sleepHours").value,r=document.getElementById("notes").value,a={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+o},body:JSON.stringify({entry_date:e,mood:t,weight:i,sleep_hours:c,notes:r})};s("http://localhost:3000/api/entries",a).then(d=>{const u=document.getElementById("notification");u.classList.add("show-notification"),setTimeout(()=>{u.classList.remove("show-notification")},3e3)}).catch(d=>{console.error("Error adding entry:",d)})});const f=document.querySelector(".add-activity");f.addEventListener("click",async n=>{n.preventDefault();let o=localStorage.getItem("token");const e=document.getElementById("activityType").value,t=document.getElementById("intensity").value,i=document.getElementById("duration").value,c={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+o},body:JSON.stringify({activity_type:e,intensity:t,duration:i})};s("http://localhost:3000/api/activities",c).then(a=>{const l=document.getElementById("notificationActivity");l.classList.add("show-notification"),setTimeout(()=>{l.classList.remove("show-notification")},3e3)}).catch(a=>{console.error("Error adding activity:",a)})});const k=document.querySelector(".get_users");k.addEventListener("click",y);async function y(){const n="http://localhost:3000/api/users",e={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};s(n,e).then(t=>{T(t)})}function T(n){console.log(n);const o=document.querySelector(".tbody");o.innerHTML="",n.forEach(e=>{console.log(e.username);const t=document.createElement("tr"),i=document.createElement("td");i.innerText=e.username;const c=document.createElement("td");c.innerText=e.user_level;const r=document.createElement("td"),a=document.createElement("button");a.className="check",a.setAttribute("data-id",e.user_id),a.innerText="Info",r.appendChild(a),a.addEventListener("click",S);const l=document.createElement("td"),d=document.createElement("button");d.className="del",d.setAttribute("data-id",e.user_id),d.innerText="Delete",l.appendChild(d),d.addEventListener("click",I);const u=document.createElement("td");u.innerText=e.user_id,t.appendChild(i),t.appendChild(c),t.appendChild(r),t.appendChild(l),t.appendChild(u),o.appendChild(t)})}const h=document.querySelector(".info_dialog"),B=document.querySelector(".info_dialog button");B.addEventListener("click",()=>{h.close()});async function S(n){const o=n.target.attributes["data-id"].value;console.log("Getting individual data for ID:",o);const e=`http://127.0.0.1:3000/api/users/${o}`,i={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};s(e,i).then(c=>{console.log(c),h.showModal(),console.log("in modal"),h.querySelector("p").innerHTML=`
          <div>User ID: <span>${c.user_id}</span></div>
          <div>User Name: <span>${c.username}</span></div>
          <div>Email: <span>${c.email}</span></div>
          <div>Role: <span>${c.user_level}</span></div>
    `})}async function I(n){console.log("Deletoit tietoa");const o=n.target.attributes["data-id"].value;n.target.parentElement.nextElementSibling.textContent;const e=`http://127.0.0.1:3000/api/users/${o}`,i={method:"DELETE",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};confirm(`Oletko varma, että haluat poistaa käyttäjän ID: ${o} `)&&s(e,i).then(r=>{console.log(r),y()})}async function b(){const n="http://localhost:3000/api/auth/me",e={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};s(n,e).then(t=>{console.log(t);const i=t.user.username;document.getElementById("name").innerHTML=i,w(i)})}async function w(n){const e=new Date().getHours();let t;e>=5&&e<12?t="Hyvää huomenta":e>=12&&e<18?t="Hyvää päivää":t="Hyvää iltaa",document.querySelector(".user").innerHTML=`${t} käyttäjä, <strong>${n}</strong>!`}document.querySelector(".update_user").addEventListener("click",L);async function L(n){n.preventDefault();const o="http://127.0.0.1:3000/api/users/";let e=localStorage.getItem("token");const t=document.getElementById("username").value,i=document.getElementById("password").value,c=document.getElementById("email").value,r={username:t,password:i,email:c},a={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(r)};s(o,a).then(l=>{console.log(l)})}document.querySelector(".logout").addEventListener("click",x);function x(n){n.preventDefault(),localStorage.removeItem("token"),console.log("logginout"),window.location.href="index.html"}b();
